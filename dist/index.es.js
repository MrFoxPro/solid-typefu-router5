import{createContext as t,useContext as n,Match as e,Show as r,Switch as o,createState as i,createMemo as c,createEffect as s,createSignal as u}from"solid-js";import{template as a,delegateEvents as l,spread as f,effect as d,classList as v,setAttribute as h}from"solid-js/dom";const p=t();function m(){return n(p).getRoute}const g=a('<button disabled=""></button>',2),b=a("<a></a>",2);var k;function y(t){return"string"==typeof t?t:t.join(".")}!function(t){t[t.Back=0]="Back",t[t.Forward=1]="Forward"}(k||(k={}));const $={navActiveClassName:"is-active"};function P(t,e=$){const{router5:r}=t,{navActiveClassName:o=$.navActiveClassName}=e;return t=>{const e=n(p).getRouteName;function i(){var n,r;const i=null!==(n=null===(r=t.innerProps)||void 0===r?void 0:r.classList)&&void 0!==n?n:{};return void 0===t.type&&t.nav?(i[o]=function(t,n){if("string"==typeof n){let e=n,r=0;for(;r<t.length;r++){const n=t[r];if(n!==e.slice(0,n.length)||"."!==e[n.length])return!1;e=e.slice(0,n.length+1)}return n.length<=r}if(n.length>t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}(e(),t.to),i):i}function c(n){var e;switch(n.preventDefault(),t.type){case void 0:r.navigate(y(t.to),null!==(e=t.params)&&void 0!==e?e:{}),"function"==typeof t.onClick&&t.onClick(n);break;case k.Back:case k.Back:window.history.back()}n.target.blur()}return t.disabled?(()=>{const n=g.cloneNode(!0);return f(n,()=>t.innerProps,!1,!1),d(t=>v(n,i(),t)),n})():(()=>{const n=b.cloneNode(!0);return n.__click=c,f(n,()=>t.innerProps,!1,!1),d(e=>{const o=i(),c=void 0===t.type?r.buildPath(y(t.to),t.params):void 0;return e._v$=v(n,o,e._v$),c!==e._v$2&&h(n,"href",e._v$2=c),e},{_v$:void 0,_v$2:void 0}),n})()}}l(["click"]);const _=t("");function w(t){const r=m(),o=n(_),i=void 0!==t.path?t.path:t.prefix,c=void 0!==t.path,s=""!==o?`${o}.${i}`:i;return()=>e({when:c?r().name===s:r().name.startsWith(s),children:_.Provider({value:s,children:()=>t.children})})}function N(t){const e=m(),o=n(_),i=void 0!==t.path?t.path:t.prefix,c=void 0!==t.path,s=""!==o?`${o}.${i}`:i;return()=>r({when:c?e().name===s:e().name.startsWith(s),fallback:()=>t.fallback,children:_.Provider({value:s,children:()=>t.children})})}function C(t){return t.children}function R(t){const n=m();function e(t,e,r,o){const[u,a]=i(o);const l=c(()=>{const e=n().name,r=e.split(".");return r.splice(0,t.length),[e,r]},void 0,(t,n)=>t&&t[0]===n[0]);return s(()=>{const t={};(function t(n,e,r,o){for(const i in e){const c=e[i];if("function"!=typeof c){if(void 0!==c&&n[0]===i)return t(n.slice(1),c,r,o)}else{const t=c();r[i]=t,o++}}return o})(l()[1],e,t,0)>0&&a(t)}),r(u)}return function t(n,r){if("function"==typeof r)return r((function(t){const{props:r,render:o,defaultProps:i}=t;return e(n,r,o,i)}));const i=[];let{render:c,fallback:s,...u}=r;if(void 0===c&&(c=C),"function"==typeof c){for(const e in u){const r=[...n,e],o=u[e];i.push(w({path:e,prefix:void 0,children:()=>t(r,o)}))}return c({children:o({fallback:"function"==typeof s?s({children:i}):void 0,children:i})})}}([],t)}function j(t,n,e){const r=n(t),o={routes:t,router5:r};return Object.freeze(o),{Link:P(o),Router:t=>R(t.children),Provider(t){const n=r.getState(),[i,a]=u(n),[l,f]=u(n.name,(t,n)=>t===n),d=c(()=>l().split("."),n.name.split("."));return s(()=>{r.subscribe(t=>{a(t.route),f(t.route.name)}),r.start(),"function"==typeof e&&e(r)}),p.Provider({value:{getRoute:i,getRouteName:d,router:o},children:t.children})},router:o}}export{k as LinkNav,w as MatchRoute,N as ShowRoute,j as createSolidRouter,C as passthru};
